<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308094 (ko-KR, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4426"/>

<div>
<span><div><div><b><font style="font-size: 14pt;">필요한 파일</font></b></div><div><br/></div><div>ASIP Designer 로 프로세서 만드려면 </div><div><br/></div><div>Primitive header file (.h)  : nML, header, pdg 파일에서 사용될 data type 과 operation을 선언한다. </div><div><br/></div><div>nML file (.n) : 메모리, I/O port, Pipeline 등 구조적인 뼈대를 만들고 Instruction-set 문법을 작성한다.</div><div><br/></div><div>PDG file : behavioral model 이 PDG 언어로 기술된다. </div><div><br/></div><div>가 필요하다. </div><div><br/></div><div>또 컴파일 하기 위해 </div><div><br/></div><div>프로세서이름_chess.h 필요</div><div><br/></div><hr/><div><br/></div><div><b><font style="font-size: 12pt;">Primitive header file</font></b></div><div><br/></div><div>처음에 헤더 파일이 겹치지 않도록</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#ifndef</div><div>#define </div><div><br/></div><div>...</div><div><br/></div><div>#endif</div></div><div><br/></div><div>해준다. </div><div><br/></div><div>안에 사용할 데이터 타입</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>class word property(16 bit unsigned); 같이</div></div><div><br/></div><div>사용할 연산</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>word add (word, word) property(commutative); // commutative 인자 바꿔서 넣어도 된다는 뜻 </div><div>bool lt(word, word);</div><div>void jumpi(sbyte) 등을 선언한다.</div></div><div><br/></div><hr/><div><br/></div><div><b><font style="font-size: 12pt;">nML</font></b></div><div><br/></div><div>tinycore 그림. 이거대로 만들어 보자. </div><div><img src="tinycore 만들기_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>DM : data memory</div><div>Ld, St : load와 store </div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>DM 예</div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">def dmSize = 2**10;</span></div><div><br/></div><div>mem DM[dmSize] &lt;word, word&gt; read(dmLdBus) write(dmStBus);</div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">read, write는 line 기준으로 </span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">Processor memory (PM) 도 생각해 주어야 한다.</span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>R의 하위 최상위 2bit은 LR 과 SP인데</div><div><br/></div><div>reg R[8]&lt;word, threebitsu&gt; syntax (eR)    </div><div>                                             read    (aluA aluB dmStBus)</div><div>                                             write    (aluC dmLdBus);</div><div>reg LR&lt;word&gt; alias R[6];</div><div>reg LR&lt;word&gt; alias R[7];</div><div><br/></div><div>이렇게 처리를 해줬다.</div></div><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">아래 const 선언에서 </span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">cst c_8s &lt;sbyte&gt;; cst가 무슨 뜻인지 모르겠다. const string 인가</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">trn 은 저장소 개념</span></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>properties </div><div>JSON 형식으로 뭘 맞춰서 지정해 주는 것 같다. </div></div><div><br/></div><div><br/></div><div>다음 ISA grammar</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">시작 부분 start processor name ex) start testcore; 로 시작한다. </span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">처음에 사용할 연산 이름과 opcode 정의</span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">그 아래부터 구체적인 동작 </span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">ALU면 </span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">opn alu_opn (op : alu_op, a : eR, b : eR) // alu_op, eR은 위에서 erum 형식으로 정의되어 있다. </span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">action {</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">stage E1: </span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">... 으로 파이프라인 각 stage마다 동작 정의 </span></div></div><div><br/></div><div><br/></div><div>등등 잘 만들면 된다. </div><div><br/></div><div>마지막에 load delay 를 위해 sw를 잠시 멈추는 부분.</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sw_stall 1 cycles class(delayed_load) () {</div><div><span>    stage E2: R[#] = .../;</span><br/></div><div><span>} -&gt; {</span></div><div><span><span>    stage E1: ... = R[#];</span><br/></span></div><div><span>}</span></div></div><div><br/></div><div><br/></div><hr/><div><br/></div><div><b><font style="font-size: 13pt;">PDG파일</font></b></div><div><br/></div><div>사용했던 연산 구체적으로 C 언어 형태로 정의한다. </div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>word add(word a, word b) {return a+b;}</div><div><br/></div><div>...</div><div><br/></div><div>void nop() {}</div></div><div><br/></div><div>이런식으로 정한다. </div><div><br/></div><hr/><div><br/></div><div><b><font style="font-size: 12pt;">_chess.h</font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><font style="font-size: 10pt;">testcore.h 를 include 해서 컴파일러가 알 수 있게 C언어 형태로 바꿀 양식 정해주는 것같음</font></div><div><font style="font-size: 10pt;"><br/></font></div><div><font style="font-size: 10pt;">앞에서 그냥 썼던 word 타입도 여기서 int, unsigned, void* 타입에 사용된다고 나와있다.</font></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>default_memory : DM</div><div>status_register : SREG</div></div><div><br/></div><div>등 필수적인 요소는 JSON 형태처럼 정의해주는 것 같다. </div><div><br/></div><div>빌트인 operator 정의도 한다. </div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>promotion int operator+(int,int) = word add(word,word);</div><div>..</div><div>promotion bool operator&lt; (int,int) = bool lt(word,word);</div><div>..</div><div>promotion void* operator+(void*, int) = word add(word,word); //주소연산 위한 것</div><div><br/></div><div>등등 이렇게 정의해뒀다. </div><div><br/></div><div>안쓰는 건 = undefined 했다.</div><div><br/></div><div>promotion operator void*(int) = nil; 이런식의 typecasting 도 지원하는 것 같은데 nil 은 뭔지 모르겠다. 타입캐스팅부분에만 있다. </div></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><hr/><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;">여기까지 하면 라이브러리 없이 작성하고 정의한 연산만 수행하는 C코드는 돌아간다. </font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><span style="font-size: 12pt;"><b>printf 하려면 char 등의 다른 타입을 사용하는 stdio.h랑 linking 하는데 타입 정의 안해서 에러난다. </b></span></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div><div><b><font style="font-size: 12pt;"><br/></font></b></div></div></span>
</div></body></html> 